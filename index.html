<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PFL Live Scores</title>
<style>
body { font-family: Arial,sans-serif; margin:0; background:#111; color:#fff;}
header { background:gold; color:black; text-align:center; padding:15px; font-weight:bold; }
.container { max-width:1200px; margin:auto; padding:10px;}
.card { background:#222; border:1px solid gold; border-radius:8px; padding:10px; margin-bottom:10px;}
h2 {margin-top:20px;}
table {width:100%; border-collapse:collapse; margin-bottom:20px;}
th, td {border:1px solid gold; padding:5px; text-align:center;}
.live {color:red; font-weight:bold;}
</style>
</head>
<body>
<header>Pinnacle Football League - Live Scores</header>
<div class="container">
  <h2>League Table</h2>
  <table id="leagueTable">
    <thead>
      <tr><th>Team</th><th>MP</th><th>W</th><th>D</th><th>L</th><th>GF</th><th>GA</th><th>GD</th><th>Pts</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Matches</h2>
  <div id="matchesContainer"></div>

  <h2>Semi-Finals</h2>
  <div id="semiContainer"></div>

  <h2>Third Place</h2>
  <div id="thirdContainer"></div>

  <h2>Final</h2>
  <div id="finalContainer"></div>
</div>

<script>
// Load JSON
let data = {};
fetch("data.json")
  .then(res=>res.json())
  .then(json=>{ data=json; render(); })
  .catch(err=>{ console.error("Failed to load data.json",err); });

// Render everything
function render(){
  renderLeagueTable();
  renderMatches();
  renderKnockouts();
}

// Calculate league table
function renderLeagueTable(){
  const teams = data.teams.map(t=>{
    return {name:t, MP:0,W:0,D:0,L:0,GF:0,GA:0,GD:0,Pts:0};
  });

  data.matchDays.forEach(day=>{
    day.matches.forEach(m=>{
      if(m.homeScore!==null && m.awayScore!==null){
        const home = teams.find(t=>t.name===m.home);
        const away = teams.find(t=>t.name===m.away);
        home.MP++; away.MP++;
        home.GF+=m.homeScore; home.GA+=m.awayScore;
        away.GF+=m.awayScore; away.GA+=m.homeScore;
        home.GD = home.GF-home.GA;
        away.GD = away.GF-away.GA;
        if(m.homeScore>m.awayScore){ home.W++; home.Pts+=3; away.L++; }
        else if(m.homeScore<m.awayScore){ away.W++; away.Pts+=3; home.L++; }
        else { home.D++; home.Pts+=1; away.D++; away.Pts+=1; }
      }
    });
  });

  teams.sort((a,b)=>b.Pts-b.DG || b.GD-b.GD);

  const tbody = document.querySelector("#leagueTable tbody");
  tbody.innerHTML="";
  teams.forEach(t=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${t.name}</td><td>${t.MP}</td><td>${t.W}</td><td>${t.D}</td><td>${t.L}</td><td>${t.GF}</td><td>${t.GA}</td><td>${t.GD}</td><td>${t.Pts}</td>`;
    tbody.appendChild(tr);
  });

  // Save top 4 for semi-finals
  data.top4 = teams.slice(0,4).map(t=>t.name);
}

// Render match days
function renderMatches(){
  const container=document.getElementById("matchesContainer");
  container.innerHTML="";
  data.matchDays.forEach((day,i)=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`<h3>Match Day ${i+1} - ${day.date}</h3>`;
    day.matches.forEach(m=>{
      const liveClass = m.live?"live":"";
      div.innerHTML+=`<p class="${liveClass}">${m.home} ${m.homeScore!==null?m.homeScore:"-"} vs ${m.awayScore!==null?m.awayScore:"-"} ${m.away} | ${m.time} | ${m.venue}</p>`;
    });
    container.appendChild(div);
  });
}

// Render semi-finals, third, final
function renderKnockouts(){
  const semi=document.getElementById("semiContainer");
  semi.innerHTML="";
  if(data.semiFinals){
    data.semiFinals.forEach((m,i)=>{
      semi.innerHTML+=`<p>SF${i+1}: ${m.home??"-"} ${m.homeScore??"-"} vs ${m.away??"-"} ${m.awayScore??"-"} | ${m.venue} ${m.time??""}</p>`;
    });
  }
  const third=document.getElementById("thirdContainer");
  if(data.thirdPlace){
    third.innerHTML=`<p>${data.thirdPlace.home??"-"} ${data.thirdPlace.homeScore??"-"} vs ${data.thirdPlace.away??"-"} ${data.thirdPlace.awayScore??"-"} | ${data.thirdPlace.venue} ${data.thirdPlace.time??""}</p>`;
  }
  const final=document.getElementById("finalContainer");
  if(data.finals){
    final.innerHTML=`<p>${data.finals.home??"-"} ${data.finals.homeScore??"-"} vs ${data.finals.away??"-"} ${data.finals.awayScore??"-"} | ${data.finals.venue} ${data.finals.time??""}</p>`;
  }
}
</script>
</body>
</html>
